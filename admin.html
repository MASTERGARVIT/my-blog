<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Admin Panel</title>

  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background: #f4f4f4;
    }
    .post {
      background: white;
      padding: 15px;
      margin-bottom: 15px;
      border-radius: 8px;
    }
    button {
      margin-right: 10px;
      padding: 6px 10px;
      cursor: pointer;
    }
  </style>
</head>

<body>

  <!-- LOGIN -->
  <div id="loginBox">
    <h2>üîê Admin Login</h2>
    <button id="loginBtn">Login with Google</button>
  </div>

  <!-- ADMIN PANEL -->
  <div id="adminPanel" style="display:none">
    <h1>üõ† Admin Panel</h1>
    <button onclick="logout()">Logout</button>
    <div id="posts"></div>
  </div>

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

  <script>
    // Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyAekZadiPdthoDtw_MvMIO8OibIz3lqa0A",
      authDomain: "master-blog-ce4e5.firebaseapp.com",
      projectId: "master-blog-ce4e5",
    };

    firebase.initializeApp(firebaseConfig);

    const auth = firebase.auth();
    const db = firebase.firestore();

    const ADMIN_EMAIL = "garvitjain118@gmail.com";

    document.getElementById("loginBtn").onclick = login;

    function login() {
      const provider = new firebase.auth.GoogleAuthProvider();
      auth.signInWithPopup(provider);
    }

    function logout() {
      auth.signOut();
    }

    auth.onAuthStateChanged(user => {
      if (!user) {
        document.getElementById("loginBox").style.display = "block";
        document.getElementById("adminPanel").style.display = "none";
        return;
      }

      if (user.email !== ADMIN_EMAIL) {
        alert("Access denied");
        auth.signOut();
        return;
      }

      // ‚úÖ ADMIN VERIFIED
      document.getElementById("loginBox").style.display = "none";
      document.getElementById("adminPanel").style.display = "block";
      loadPendingPosts();
    });

    function loadPendingPosts() {
      db.collection("posts")
        .where("status", "==", "pending")
        .onSnapshot(snapshot => {
          const container = document.getElementById("posts");
          container.innerHTML = "";

          snapshot.forEach(doc => {
            const post = doc.data();
            container.innerHTML += `
              <div class="post">
                <h3>${post.title}</h3>
                <p>${post.content}</p>
                <button onclick="approve('${doc.id}')">Approve</button>
                <button onclick="removePost('${doc.id}')">Delete</button>
              </div>
            `;
          });
        });
    }

    function approve(id) {
      db.collection("posts").doc(id).update({ status: "published" });
    }

    function removePost(id) {
      db.collection("posts").doc(id).delete();
    }
  </script>

</body>
</html>

